#| fig-cap
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/model4-assumptions.png"))
models <- c(cell_lm, af_lm, cell_af_lm, cell_slope_lm)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp |>
gt()
models <- c(cell_lm, af_lm, cell_af_lm, cell_slope_lm)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp |>
gt:;gt()
models <- c(cell_lm, af_lm, cell_af_lm, cell_slope_lm)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp |>
gt::gt()
models <- c(cell_lm, af_lm, cell_af_lm, cell_slope_lm)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp
RMSE
R2
R2
af_slope_lm <- lmer(gene_expression ~
(1 | activating_factor) + (conc | cell_type),
data=genes)
summary(af_slope_lm)
AIC(af_slope-lm)
AIC(af_slope_lm)
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp |>
gt()
pacman::p_load(tidyverse, gt)
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp |>
gt()
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, latex2exp(r'R^2')=R2)
latex2exp(r'R^2')
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, latex2exp::TeX(r'R^2')=R2)
latex2exp::TeX(r'R^2')
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, latex2exp::TeX(r'$R^2$')=R2)
latex2exp::TeX(r'$R^2$')
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, latex2exp::TeX(r'($R^2$)')=R2)
latex2exp::TeX(r'($R^2$)')
colnames
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
colnames(model_comp) <- c("Model", "RMSE", latex2exp::TeX(r'($R^2$)'))
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp <- model_comp |>
rename(latex2exp::TeX(r'($R^2$)') = R2)
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
model_comp <- model_comp |>
rename(latex2exp::TeX(r'($R^2$)') = "R2")
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", latex2exp::TeX(r'($R^2$)'))
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", "$R^2$")
model_comp |>
fmt_number(decimals=4) |>
gt()
model-comp
model_comp
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", "$R^2$")
model_comp |>
knitr::kable() |>
fmt_number(decimals=4) |>
gt()
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", "$R^2$")
model_comp |>
knitr::kable() |>
gt() |>
fmt_number(decimals=4)
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", "$R^2$")
model_comp |>
gt() |>
fmt_number(decimals=4)
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", latex2exp::TeX(r"($R^2$)"))
RMSE <- c(4.428235, 4.426161, 4.428354, 3.267196)
R2 <- c(0.8303221, 0.8304817, 0.8303269, 0.9076429)
models <- c("Cell Intercept", "Treatment Intercept",
"Cell and Treatment Intercept", "Cell Intercept and Treatment Slope")
model_comp <- tibble(Model=models, RMSE=RMSE, R2=R2)
names(model_comp) <- c("Model", "RMSE", "R2")
model_comp |>
gt() |>
fmt_number(decimals=4)
#| label: fig-plot
#| fig-cap: Plot of gene expression versus concentration of treatment factor for the two cell types and two treatment factors, indicated by subplot and colour, respectively. We notice
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/mode-plot.png"))
#| label: fig-plot
#| fig-cap: Plot of gene expression versus concentration of treatment factor for the two cell types and two treatment factors, indicated by subplot and colour, respectively. We notice
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/model-plot.png"))
coefs(cell_slope_lm)
coef(cell_slope_lm)
summary(cell_slope_lm)
summary(cell_slope_lm) |> gt()
coef(cell_slope_lm) |> gt()
coef(cell_slope_lm)
coef(cell_slope_lm)$cell_type
coef(cell_slope_lm)$cell_type |> gt()
cell_coefs <- coef(cell_slope_lm)$cell_type
af_coefs <- coef(cell_slope_lm)$activating_factor
write.table(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type
af_coefs <- coef(cell_slope_lm)$activating_factor
write.table(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
write.table(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs < read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs < read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs
cell_coefs
cell_coefs < read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell_coefs, af_coefs)
all_coefs |>
gt()
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = TRUE) |>
fmt_number(decimals = 4) |>
cols_label(cell = "Cell Type", af = "Treatment")
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = everything()) |>
fmt_number(decimals = 4) |>
cols_label(cell = "Cell Type", af = "Treatment")
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_number(decimals = 4) |>
cols_label(cell = "Cell Type", af = "Treatment")
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = TRUE) |>
fmt_number(decimals = 4)
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = everything()) |>
fmt_number(decimals = 4)
af_coefs
cell_coefs
coef(cell_slope_lm)$activating_factor
bibliography: references.bib
all_coefs
#| label: fig-clsm
#| fig-cap: Residuals vs fitted for the model using cell type to vary the intercept and activating factor to vary the slope. While it still shows some fanning, it meets our assumption of homoscedasticity more effectively.
pdf(here::here("figs/2023-05-08-mixed-effects/model4-assumptions.png"))
plot(cell_slope_lm)
dev.off()
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = everything()) |>
fmt_number(decimals = 4)
cell_coefs <- coef(cell_slope_lm)$cell_type
af_coefs <- coef(cell_slope_lm)$activating_factor
write.table(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
write.table(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
#| label: tbl-model
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
all_coefs <- data.frame(cell = cell_coefs, af = af_coefs)
all_coefs |>
gt() |>
fmt_markdown(columns = everything()) |>
fmt_number(decimals = 4)
cell_coefs
all_coefs |>
gt() |>
fmt_number(decimals = 4)
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
cell_coefs |>
gt() |>
fmt_number(decimals = 4)
all_coefs |>
gt() |>
fmt_number(decimals = 4)
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
cell_coefs |>
gt() |>
fmt_number(decimals = 4)
af_coefs |>
gt() |>
fmt_number(decimals = 4)
names(cell_coefs)
cell_coefs
cell_coefs$conc..Intercept.
coef(cell_slope_lm)$cell_type
coef(cell_slope_lm)$cell_type |> kable()
coef(cell_slope_lm)$cell_type |> knitr::kable()
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
write.table(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
knitr:;save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
knitr::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
knitrExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
?save_kable
>?save_kable
??save_kable
??save
pacman::p_load(tidyverse, lme4, ggrepel, paletteer, vip, kableExtra)
genes <- read.csv(here::here("data", "melted-gene-WTF-IISfD-data.csv"))
head(genes)
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
kableExtra::save_kable(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.tbl"))
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.csv"))
af_coefs <- read.csv(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.csv"))
cell_coefs |>
gt() |>
fmt_number(decimals = 4)
af_coefs |>
gt() |>
fmt_number(decimals = 4)
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read.html(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
?read_html
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- read_html(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
# kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
# skableExtra::save_kable(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.tbl"))
cell_coefs
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
# kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
# skableExtra::save_kable(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.tbl"))
cell_coefs
af_coefs
coef(cell_slope_lm)$cell_type
coef(cell_slope_lm)$cell_type |> knitr::kable()
cell_coefs <- coef(cell_slope_lm)$cell_type |> knitr::kable()
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
cell_coefs
# kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
# skableExtra::save_kable(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.tbl"))
coef(cell_slope_lm)$cell_type
colnames(coef(cell_slope_lm)$cell_type)
colnames(coef(cell_slope_lm)$cell_type) <- c("Concentration", "Intercept")
names(coef(cell_slope_lm)$cell_type) <- c("Concentration", "Intercept")
cell_coefs <- coef(cell_slope_lm)$cell_type
names(cell_coefs)
names(cell_coefs)[1]
names(cell_coefs)[2]
names(cell_coefs) <- c("Concentration", "Intercept")
cell_coefs
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename(c("Concentration", "Intercept"))
cell_coefs
ccoef(cell_slope_lm)$cell_type
coef(cell_slope_lm)$cell_type
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("conc"="Concentration", "(Intercept)"="Intercept"))
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("conc"="Concentration", "(Intercept)"="Intercept")
cellcoef(cell_slope_lm)$cell_type
coef(cell_slope_lm)$cell_type
names(coef(cell_slope_lm)$cell_type)
colnames(coef(cell_slope_lm)$cell_type)
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)")
af_coefs <- coef(cell_slope_lm)$activating_factor |> knitr::kable()
cell_coefs
# kableExtra::save_kable(cell_coefs, here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
# skableExtra::save_kable(af_coefs, here::here("tabs/2023-05-08-mixed-effects/af-coefficients.tbl"))
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4) |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png")
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4)
# |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png")
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4) |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
af_coefs <- coef(cell_slope_lm)$activating_factor |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4) |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.png"))
af_coefs
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- knitr::include_graphics(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.tbl"))
#| label: tbl-model
#| layout-ncol: 2
#| tbl-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
cell_coefs <- knitr::include_graphics(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
af_coefs <- knitr::include_graphics(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.png"))
#| label: fig-clsm
#| fig-cap: Residuals vs fitted for the model using cell type to vary the intercept and activating factor to vary the slope. While it still shows some fanning, it meets our assumption of homoscedasticity more effectively.
pdf(here::here("figs/2023-05-08-mixed-effects/model4-assumptions.pdf"))
plot(cell_slope_lm)
dev.off()
#| label: fig-assumptions
#| fig-cap: Residuals versus fitted plot for the final model, which varies intercept by cell type and slope by treatment type. There is some mild heteroscedasticity of the residuals, indicating that this assumption of linear modelling has not entirely been fulfilled.
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/model4-assumptions.pdf"))
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4) #|>
# gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
gt() |>
fmt_number(decimals = 4) #|>
# gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
cell_coefs
coef(cell_slope_lm)$cell_type
dim(coef(cell_slope_lm)$cell_type)
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
mutate("Cell Type" = c("101", "Wild")) |>
gt() |>
fmt_number(decimals = 4) #|>
# gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
cell_coefs
cell_coefs <- coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
mutate("Cell Type"=c("101", "Wild"), .before="Concentration") |>
gt() |>
fmt_number(decimals = 4) #|>
# gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
cell_coefs
coef(cell_slope_lm)$cell_type |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
mutate("Cell Type"=c("101", "Wild"), .before="Concentration") |>
gt() |>
fmt_number(decimals = 4) |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
coef(cell_slope_lm)$activating_factor
coef(cell_slope_lm)$activating_factor |>
rename("Concentration"="conc", "Intercept"="(Intercept)") |>
mutate("Treatment"=c("Activating Factor 42", "Placebo"), .before="Concentration") |>
gt() |>
fmt_number(decimals = 4) |>
gtsave(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.png"))
#| label: fig-model
#| layout-ncol: 2
#| fig-cap: Coefficients of the chosen model. We see that 101 Type cells have a higher intercept than Wild Type cells, and that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression, especially in Wild Type cells.
knitr::include_graphics(here::here("tabs/2023-05-08-mixed-effects/cell-coefficients.png"))
knitr::include_graphics(here::here("tabs/2023-05-08-mixed-effects/af-coefficients.png"))
#| label: fig-assumptions
#| width: 80%
#| fig-cap: Residuals versus fitted plot for the final model, which varies intercept by cell type and slope by treatment type. There is some mild heteroscedasticity of the residuals, indicating that this assumption of linear modelling has not entirely been fulfilled.
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/model4-assumptions.pdf"))
?include_graphics
summary(cell_slope_lm)
