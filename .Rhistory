# facet_wrap(~ cell_type, scales="free",
#            labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
label = "Gene Line") +
theme(legend.position="bottom") +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
# ggsave(here::here("figs/2023-05-08-mixed-effects/model-plot.pdf"))
#| label: fig-m2fit
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points.
cell_type.labs <- c("101 Type Cell", "Wild Type Cell")
names(cell_type.labs) <- c("C101", "WT")
genes |>
ggplot(aes(x=conc, y=gene_expression, color=treatment, shape=cell_type,
label=ifelse(conc==10, as.character(gene_line),''))) +
geom_point() +
geom_label_repel(nudge_x = 2,
direction = "y",
show.legend = FALSE) +
geom_line(aes(y=predict(m2))) +
facet_wrap(~ gene_line, scales="free") +
# facet_wrap(~ cell_type, scales="free",
#            labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
shape = "Cell Type",
label = "Gene Line") +
theme(legend.position="bottom") +
scale_shape_manual(labels=c("101 Type Cell", "Wild Type Cell")) +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
#| label: fig-m2fit
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points.
cell_type.labs <- c("101 Type Cell", "Wild Type Cell")
names(cell_type.labs) <- c("C101", "WT")
genes |>
ggplot(aes(x=conc, y=gene_expression, color=treatment, shape=cell_type,
label=ifelse(conc==10, as.character(gene_line),''))) +
geom_point() +
geom_label_repel(nudge_x = 2,
direction = "y",
show.legend = FALSE) +
geom_line(aes(y=predict(m2))) +
facet_wrap(~ gene_line, scales="free") +
# facet_wrap(~ cell_type, scales="free",
#            labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
shape = "Cell Type",
label = "Gene Line") +
theme(legend.position="bottom") +
scale_shape(labels=c("101 Type Cell", "Wild Type Cell")) +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
# ggsave(here::here("figs/2023-05-08-mixed-effects/model-plot.pdf"))
#| label: fig-m2fit
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points. There is a better fit on the gene lines that used Activating Factor 42 as the applied treatment, compared with the Placebo.
genes |>
ggplot(aes(x=conc, y=gene_expression, color=treatment, shape=cell_type,
label=ifelse(conc==10, as.character(gene_line),''))) +
geom_point() +
geom_label_repel(nudge_x = 2,
direction = "y",
show.legend = FALSE) +
geom_line(aes(y=predict(m2))) +
facet_wrap(~ gene_line, scales="free") +
# facet_wrap(~ cell_type, scales="free",
#            labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
shape = "Cell Type",
label = "Gene Line") +
theme(legend.position="bottom") +
scale_shape(labels=c("101 Type Cell", "Wild Type Cell")) +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
ggsave(here::here("figs/2023-05-08-mixed-effects/model-plot.pdf"))
coef(m2)
coef(m2) |> knitr::kable()
coef(m2) |> gt() |> knitr::kable()
coef(m2) |> gt()
coef(m2) |> gt()
coef(m2)$gene_line |> gt()
coef(m2)
coef(m2)$gene_line
?gt
genes$gene_line
unique(genes$gene_line)
sort(unique(genes$gene_line))
coef(m2)$gene_line |>
gt(id=sort(unique(genes$gene_line))) |>
fmt_number(decimals=4)
sort(unique(genes$gene_line))
len(sort(unique(genes$gene_line)))
length(sort(unique(genes$gene_line)))
coef(m2)$gene_line
sort(unique(genes$gene_line))
type(sort(unique(genes$gene_line)))
class(sort(unique(genes$gene_line)))
length([sort(unique(genes$gene_line))])
length((sort(unique(genes$gene_line))))
coef(m2)$gene_line |>
gt(id=[sort(unique(genes$gene_line))]) |>
coef(m2)$gene_line |>
gt() |>
fmt_number(decimals=4)
coef(m2)$gene_line |>
gt(id=genes$gene_line) |>
fmt_number(decimals=4)
coef(m2)$gene_line |>
gt(id=flatten(sort(genes$gene_line))) |>
fmt_number(decimals=4)
flflatten(sort(genes$gene_line))
flatten(sort(genes$gene_line))
#| label: fig-eda
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points. There is a better fit on the gene lines that used Activating Factor 42 as the applied treatment, compared with the Placebo.
genes |>
ggplot(aes(x=conc, y=gene_expression, color=treatment,
label=ifelse(conc==10, as.character(gene_line),''))) +
geom_point() +
geom_label_repel(nudge_x = 2,
direction = "y",
show.legend = FALSE) +
facet_wrap(~ cell_type, scales="free",
labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
label = "Gene Line") +
theme(legend.position="bottom") +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
# ggsave(here::here("figs/2023-05-08-mixed-effects/model-plot.pdf"))
#| label: fig-eda
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points.
genes |>
ggplot(aes(x=conc, y=gene_expression, color=treatment,
label=ifelse(conc==10, as.character(gene_line),''))) +
geom_point() +
geom_label_repel(nudge_x = 2,
direction = "y",
show.legend = FALSE) +
facet_wrap(~ cell_type, scales="free",
labeller = labeller(cell_type = cell_type.labs)) +
labs(x = "Concentration (mg/mL)",
y = "Gene Expression",
color = "Treatment",
label = "Gene Line") +
theme(legend.position="bottom") +
paletteer::scale_color_paletteer_d("tvthemes::rickAndMorty",
labels=c("Activating Factor 42", "Placebo"))
ggsave(here::here("figs/2023-05-08-mixed-effects/model-eda.pdf"))
coef(m2)$gene_line |>
gt(row_group_as_column=TRUE) |>
fmt_number(decimals=4)
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4)
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE,
rowname_col = "Gene Line") |>
fmt_number(decimals=4)
?rownames
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line")
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept")
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo")
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs"))
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.html"))
#| fig-cap: The residuals vs fitted plot for the second model. We see that there is random scattering, so the model satisfies the homoscedasticity assumption.
#| label: fig-m2
pdf(here::here("figs", "2023-05-08-mixed-effects/model2-assumptions.pdf"))
plot(m2)
dev.off()
#| label: fig-eda
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points.
knitr::include_graphics(here::here("figs", "2023-05-08/model-eda.pdf"))
#| label: fig-eda
#| fig-cap: Plots showing the increase in gene expression as concentration of activating factor increases. We see that the Wild Type cells have a lower starting intercept value. We have also labelled the gene line for each set of eleven points.
knitr::include_graphics(here::here("figs", "2023-05-08-mixed-effects/model-eda.pdf"))
A <- AIC(m2, m5)
A
A
A <- AIC(m2, m5)
A$AIC
models <- c(m2, m5)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
RMSE=RMSE, R2=R2, AIC=A$AIC)
model_comp
models <- c(m2, m5)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
RMSE=RMSE, R2=R2, AIC=A$AIC)
model_comp |> knitr::kable()
models <- c(m2, m5)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
RMSE=RMSE, R2=R2, AIC=A$AIC)
model_comp |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
#| label: fig-m2res
#| fig-cap: Residuals versus fitted plot for the second model, which varies intercept by gene line and considers interaction between concentration of treatment and treatment type. We see there is random scattering of the residuals, satisfying the assumption of homoscedasticity.
knitr::include_graphics(here::here("figs", "2023-05-08-model2-assumptions.pdf"))
#| label: fig-m2res
#| fig-cap: Residuals versus fitted plot for the second model, which varies intercept by gene line and considers interaction between concentration of treatment and treatment type. We see there is random scattering of the residuals, satisfying the assumption of homoscedasticity.
knitr::include_graphics(here::here("figs", "2023-05-08-mixed-effects/model2-assumptions.pdf"))
models <- c(m2, m5)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
RMSE=RMSE, R2=R2, `Degrees of Freedom`=A$df, AIC=A$AIC)
model_comp |>
knitr::kable()# |>
# save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
models <- c(m2, m5)
RMSE <- c()
R2 <- c()
for(m in models){
RMSE <- append(RMSE, get_rmse_r2(m)[1])
R2 <- append(R2, get_rmse_r2(m)[2])
}
model_comp <- tibble(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
RMSE=RMSE, R2=R2,  AIC=A$AIC, `Degrees of Freedom`=A$df)
model_comp |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
#| label: tbl-comp
#| tbl-cap: Quantitative metrics for the two models. We see that the three-way interaction model has a much lower AIC than the Concentration x Treatment model, but the RMSE and $$R^2$$ are both quite similar. Given that the three-way interaction model has more degrees of freedom, we have chosen the Concentration x Treatment.
#| label: tbl-comp
#| tbl-cap: Quantitative metrics for the two models. We see that the three-way interaction model has a much lower AIC than the Concentration x Treatment model, but the RMSE and $$R^2$$ are both quite similar. Given that the three-way interaction model has more degrees of freedom, we have chosen the Concentration x Treatment.
htmltools::includeHTML(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
#| label: fig-plot
#| fig-cap: Plot of gene expression versus concentration of treatment factor for the two cell types and two treatment factors, indicated by shape and colour, respectively. We have also labelled the gene lines at their final observations. We notice that the Wild Type cells have a lower starting intercept compared with the 101 Type cells. The linear model fits the Wild Type cells more accurately than the 101 Type cells, and the same applies for the placebo treatment versus than Activating Factor 42.
#| width: 80%
knitr::include_graphics(here::here("figs/2023-05-08-mixed-effects/model-plot.pdf"), dpi=400)
#| label: tbl-coef
#| fig-cap: Coefficients of the chosen model.
#| fig-subcap:
#|   - "We see that 101 Type cells have a higher intercept than Wild Type cells indicating that these cells have higher gene expression."
#|   - We also see that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression.
htmltools::includeHTML(here::here("tabs", "2023-05-08-mixed-effects/model-coefs.html"))
#| label: tbl-coef
#| fig-cap: Coefficients of the chosen model.
#| fig-subcap:
#|   - "We see that 101 Type cells have a higher intercept than Wild Type cells indicating that these cells have higher gene expression."
#|   - We also see that Activating Factor 42 similarly has a higher intercept than placebo treatment, almost by a factor of 2. Likewise, the slope increases when Activating Factor 42 is applied, indicating that this increases gene expression.
htmltools::includeHTML(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.html"))
pacman::p_load(tidyverse, lme4, ggrepel, paletteer, vip, kableExtra, performance)
genes <- read.csv(here::here("data", "melted-gene-WTF-IISfD-data.csv"))
head(genes)
?performance
performance(m2, m5)
model_performance(m2, m5)
compare_performance(m2, m5)
class(compare_performance(m2, m5))
compare_performance(m2, m5) |>
knitr::kable()
compare_performance(m2, m5) |>
select(c(AIC, BIC, R2_conditional, RMSE))
knitr::kable()
compare_performance(m2, m5) |>
select(c(Model, AIC, R2_conditional, RMSE)) |>
knitr::kable()
compare_performance(m2, m5) |>
select(c(Model, AIC, R2_conditional, RMSE)) |>
rename(R2_conditional = "R2") |>
knitr::kable()
compare_performance(m2, m5) |>
select(c(Model, AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
knitr::kable()
citation("performance")
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
mutate(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"))
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
mutate(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type")) |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
#| label: tbl-comp
#| tbl-cap: Quantitative metrics for the two models. We see that the three-way interaction model has a much lower AIC than the Concentration x Treatment model, but the RMSE and $$R^2$$ are both quite similar. Given that the three-way interaction model has more degrees of freedom, we have chosen the Concentration x Treatment.
htmltools::includeHTML(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
#| label: tbl-comp
#| tbl-cap: Quantitative metrics for the two models. We see that the three-way interaction model has a much lower AIC than the Concentration x Treatment model, but the RMSE and $$R^2$$ are both quite similar. Given that the three-way interaction model has more degrees of freedom, we have chosen the Concentration x Treatment.
htmltools::includeHTML(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"))
?gtsave
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.html"),
inline_css=TRUE)
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"),
inline_css=TRUE))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.html"),
inline_css=TRUE)
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.html"),
inline_css=TRUE)
#| label: tbl-coef
#| fig-cap: Coefficients of the chosen model. We notice the variation in intercept across gene lines is not particularly large, with the exception of Rza and xpo, which fall out of the 10-13 gene expression units that the other gene lines satisfy. The slope is just under 3 gene expression units, we subtract almost 5 units from the intercept if placebo treatment is used and roughly 3.3 units if we apply treatment to a Wild Type cell. We also subtract 1.9 units from the the slope if placebo treatment is used, indicating that 101 Type cells with Activating Factor 42 applied exhibit the greatest gene expression.
htmltools::includeHTML(here::here("tabs",
"2023-05-08-mixed-effects/m2-coefs.html"))
tmp <- URLencode(paste(readLines(here::here("tabs",
"2023-05-08-mixed-effects/m2-coefs.html")),
collapse="\n"))
cat('<iframe src="data:text/html;charset=utf-8,', tmp ,
'" style="border: none; seamless:seamless; width: 800px; height: 200px"></iframe>')
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.pdf"),
inline_css=TRUE)
?kableExtra
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.pdf"))
#| label: tbl-coef
#| fig-cap: Coefficients of the chosen model. We notice the variation in intercept across gene lines is not particularly large, with the exception of Rza and xpo, which fall out of the 10-13 gene expression units that the other gene lines satisfy. The slope is just under 3 gene expression units, we subtract almost 5 units from the intercept if placebo treatment is used and roughly 3.3 units if we apply treatment to a Wild Type cell. We also subtract 1.9 units from the the slope if placebo treatment is used, indicating that 101 Type cells with Activating Factor 42 applied exhibit the greatest gene expression.
knitr::include_graphics(here::here("tabs",
"2023-05-08-mixed-effects/m2-coefs.pdf"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.pdf"))
webshot::install_phantomjs()
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
knitr::kable() |>
save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.pdf"))
#| label: tbl-comp
#| tbl-cap: Quantitative metrics for the two models. We see that the three-way interaction model has a much lower AIC than the Concentration x Treatment model, but the RMSE and $R^2$ are both quite similar. Given that the three-way interaction model has more degrees of freedom, we have chosen the Concentration x Treatment model.
knitr::include_graphics(here::here("tabs",
"2023-05-08-mixed-effects/model-metrics.pdf"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
gt() |>
# knitr::kable() |>
# save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.pdf"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
gt()
# knitr::kable() |>
# save_kable(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.pdf"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
gt() |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.pdf"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
gt() |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.svg"))
compare_performance(m2, m5) |>
select(c(AIC, R2_conditional, RMSE)) |>
rename("R2" = "R2_conditional") |>
add_column(Model=c("Concentration x Treatment",
"Concentration x Treatment x Cell Type"),
.before = "AIC") |>
gt() |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/model-metrics.png"))
coef(m2)$gene_line |>
gt(rownames_to_stub=TRUE) |>
fmt_number(decimals=4) |>
tab_stubhead(label="Gene Line") |>
cols_label("(Intercept)" = "Intercept",
"conc" = "Concentration (mg/mL)",
"treatmentP" = "Placebo",
"cell_typeWT" = "Wild Type Cell",
"conc:treatmentP" = "Concentration x Placebo") |>
gtsave(here::here("tabs", "2023-05-08-mixed-effects/m2-coefs.png"))
